{% extends CMSOJ/Views/admin/main.html %}

{% block title %}
  {{ $editing ? 'Edit Menu Item' : 'Create Menu Item' }}
{% endblock %}

{% block page %}
<h1>{{ $editing ? 'Edit Menu Item' : 'Create Menu Item' }}</h1>

<form method="POST" action="{{ $editing ? '/admin/menu/items/update/' . $item['id'] : '/admin/menu/items/store' }}">
  <input type="hidden" name="_csrf" value="<?= \CMSOJ\Helpers\Csrf::token() ?>">

  {% component 'admin/form/select', [
    'label'   => 'Section',
    'name'    => 'section_id',
    'id'      => 'section_id',
    'options' => $sectionOptions,
    'value'   => $old['section_id'] ?? ($item['section_id'] ?? ''),
    'error'   => $errors['section_id'] ?? null
  ] %}

  {% component 'admin/form/select', [
    'label'   => 'Display Type',
    'name'    => 'display_type',
    'id'      => 'display_type',
    'options' => [
      'item'    => 'Normal Item',
      'thead'   => 'Header Row (Table Head)',
      'th'      => 'Subheader Row (Inside Table)',
      'divider' => 'Divider (Colspan)',
    ],
    'value'   => $old['display_type'] ?? ($item['display_type'] ?? 'item'),
    'error'   => $errors['display_type'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Name (EN)',
    'name'  => 'name_en',
    'id'    => 'name_en',
    'value' => $old['name_en'] ?? ($item['name_en'] ?? ''),
    'error' => $errors['name_en'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Name (PT)',
    'name'  => 'name_pt',
    'id'    => 'name_pt',
    'value' => $old['name_pt'] ?? ($item['name_pt'] ?? ''),
    'error' => $errors['name_pt'] ?? null
  ] %}

  {% component 'admin/form/textarea', [
    'label' => 'Description (EN)',
    'name'  => 'description_en',
    'id'    => 'description_en',
    'value' => $old['description_en'] ?? ($item['description_en'] ?? ''),
    'error' => $errors['description_en'] ?? null,
    'rows'  => 3
  ] %}

  {% component 'admin/form/textarea', [
    'label' => 'Description (PT)',
    'name'  => 'description_pt',
    'id'    => 'description_pt',
    'value' => $old['description_pt'] ?? ($item['description_pt'] ?? ''),
    'error' => $errors['description_pt'] ?? null,
    'rows'  => 3
  ] %}

  <h3>Units & Prices</h3>

  {% component 'admin/form/input', [
    'label' => 'Unit 1',
    'name'  => 'unit_1_label',
    'id'    => 'unit_1_label',
    'value' => $old['unit_1_label'] ?? ($item['unit_1_label'] ?? ''),
    'error' => $errors['unit_1_label'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Price 1',
    'name'  => 'price_1',
    'id'    => 'price_1',
    'value' => $old['price_1'] ?? ($item['price_1'] ?? ''),
    'error' => $errors['price_1'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Unit 2',
    'name'  => 'unit_2_label',
    'id'    => 'unit_2_label',
    'value' => $old['unit_2_label'] ?? ($item['unit_2_label'] ?? ''),
    'error' => $errors['unit_2_label'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Price 2',
    'name'  => 'price_2',
    'id'    => 'price_2',
    'value' => $old['price_2'] ?? ($item['price_2'] ?? ''),
    'error' => $errors['price_2'] ?? null
  ] %}

  {% component 'admin/form/input', [
    'label' => 'Sort Order',
    'name'  => 'sort_order',
    'id'    => 'sort_order',
    'type'  => 'number',
    'value' => $old['sort_order'] ?? ($item['sort_order'] ?? 0),
    'error' => $errors['sort_order'] ?? null
  ] %}

  {% component 'admin/form/toggle', [
    'label'       => 'Active',
    'name'        => 'is_active',
    'id'          => 'is_active',
    'checked'     => ($old['is_active'] ?? $item['is_active'] ?? 1) ? true : false,
    'description' => 'Visible on the public menu'
  ] %}

  <button type="submit" class="btn btn-primary">Save Item</button>
</form>
{% endblock %}
