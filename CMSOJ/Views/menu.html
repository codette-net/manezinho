{% extends CMSOJ/Views/layout.html %}

{% block title %} {{ $title }} {% endblock %}

{% block meta %}
<meta name="description"
  content="Welcome to Art Restaurant Manezinho, a unique dining experience in São Jorge, Azores. Enjoy exquisite cuisine in an artistic setting. Book your table now!">
{% endblock %}


{% block css %}
@parent
<link rel="stylesheet" href="/assets/css/menu.css">
{% endblock %}


{% block content %}

{% partial 'nav' %}
<main>

  <header class="header-alt">
    <h1 class="hero-header">Art Restaurant Manezinho</h1>
    <h2 class="hero-header-h2">Menu</h2>

    <div class="lang-switch">
      <a href="?lang=en" class="<?= $lang === 'en' ? 'active' : '' ?>">English</a>
      <a href="?lang=pt" class="<?= $lang === 'pt' ? 'active' : '' ?>">Português</a>
    </div>
    <div class="section-links">
      <?php foreach ($tree as $main): ?>
      <span>
        <a href="/menu#<?= htmlspecialchars($main["name_$lang"] ?: $main["name_en"])?>">
          <?= htmlspecialchars($main["name_$lang"] ?: $main["name_en"])?>
        </a>
      </span>
      <?php endforeach; ?>

    </div>
  </header>

  <div class="wrapper">

    <?php foreach ($tree as $main): ?>
    <section class="menu-section">
      <h2 id="<?= htmlspecialchars($main["name_$lang"] ?: $main["name_en"])?>">
        <?= htmlspecialchars($main["name_$lang"] ?: $main["name_en"]) ?>
      </h2>

      <?php if ($main["description_$lang"]): ?>
      <p>
        <?= nl2br(htmlspecialchars($main["description_$lang"])) ?>
      </p>
      <?php endif; ?>

      <?php if (!empty($main['children'])): ?>
      <?php foreach ($main['children'] as $sub): ?>
      <div class="menu-subsection">
        <h3>
          <?= htmlspecialchars($sub["name_$lang"] ?: $sub["name_en"]) ?>
        </h3>
        <?php if ($sub["description_$lang"]): ?>
        <p>
          <?= nl2br(htmlspecialchars($sub["description_$lang"])) ?>
        </p>
        <?php endif; ?>
        {% component 'menu-table', [
        'id' => $sub['id'],
        'items' => $itemsBySection,
        'lang' => $lang
        ] %}


      </div>
      <?php endforeach; ?>
      <?php else: ?>
      {% component 'menu-table', ['id' => $main['id'], 'items' => $itemsBySection, 'lang' => $lang] %}

      <?php endif; ?>

  </div>
  <?php endforeach; ?>

  </div>

{% partial 'reservation' %}

</main>

{% endblock %}

{% partial 'footer' %}